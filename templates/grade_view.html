<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n-key="grade_view_title">Grade {{ grade }} - Shiksha Leap</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <div class="container">
        <!-- Header with Back Button -->
        <header class="header">
            <button class="back-btn" onclick="history.back()">‚Üê <span data-i18n-key="back">Back</span></button>
            <div class="logo">
                <img src="/static/images/logo.png" alt="Shiksha Leap" class="logo-img">
                <h1 data-i18n-key="app_name">Shiksha Leap</h1>
            </div>
        </header>

        <main class="main-content">
            <!-- Grade Header -->
            <div class="grade-header">
                <div class="grade-badge">{{ grade }}</div>
                <div class="grade-info">
                    <h2 data-i18n-key="grade_learning_hub">Grade {{ grade }} Learning Hub</h2>
                    <p data-i18n-key="choose_subject">Choose a subject to start learning</p>
                </div>
            </div>

            <!-- Subjects Section -->
            <div class="section">
                <h3 data-i18n-key="subjects">Subjects</h3>
                <div class="subjects-grid" id="subjectsGrid">
                    <!-- Subjects will be loaded dynamically -->
                </div>
            </div>

            <!-- Recommended Games -->
            <div class="section">
                <h3 data-i18n-key="recommended_games">Recommended for You</h3>
                <div class="games-grid" id="gamesGrid">
                    <!-- Games will be loaded dynamically -->
                </div>
            </div>

            <!-- AI Recommendations -->
            <div class="ai-recommendations">
                <div class="ai-header">
                    <div class="ai-icon">ü§ñ</div>
                    <div>
                        <h3 data-i18n-key="ai_recommendations">AI Recommendations</h3>
                        <p data-i18n-key="personalized_suggestions">Personalized suggestions based on your learning</p>
                    </div>
                </div>
                <div class="recommendations-grid">
                    <div class="recommendation-card">
                        <h4 data-i18n-key="strengthen_math">Strengthen Math Skills</h4>
                        <p data-i18n-key="focus_algebra">Focus on algebraic expressions based on recent performance</p>
                    </div>
                    <div class="recommendation-card">
                        <h4 data-i18n-key="explore_science">Explore Science Concepts</h4>
                        <p data-i18n-key="try_chemistry">Try chemistry experiments to complement physics knowledge</p>
                    </div>
                    <div class="recommendation-card">
                        <h4 data-i18n-key="reading_practice">Reading Practice</h4>
                        <p data-i18n-key="improve_comprehension">Improve comprehension with grade-appropriate passages</p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script src="/static/js/main.js"></script>
    <script src="/static/js/game_loader.js"></script>
    <script>
        const currentGrade = {{ grade }};

        document.addEventListener('DOMContentLoaded', function() {
            loadSubjects();
            loadRecommendedGames();
        });

        function loadSubjects() {
            // Get subjects based on grade using game loader
            let subjects = [];
            
            if (window.gameLoader) {
                const gradeSubjects = window.gameLoader.getSubjectsForGrade(currentGrade);
                subjects = gradeSubjects.map(subject => {
                    const subjectConfig = getSubjectConfig(subject.name);
                    return {
                        id: subject.id,
                        name: subject.name,
                        icon: subjectConfig.icon,
                        color: subjectConfig.color,
                        progress: Math.floor(Math.random() * 40) + 60, // Mock progress
                        gameCount: subject.gameCount
                    };
                });
            } else {
                // Fallback subjects for grades 6-10
                if (currentGrade <= 10) {
                    subjects = [
                        { id: 'english', name: 'English', icon: 'üìö', color: '#FF6B6B', progress: 85, gameCount: 2 },
                        { id: 'odia', name: 'Odia', icon: 'üèõÔ∏è', color: '#FF8C00', progress: 78, gameCount: 2 },
                        { id: 'mathematics', name: 'Mathematics', icon: 'üî¢', color: '#4A90E2', progress: 75, gameCount: 2 },
                        { id: 'science', name: 'Science', icon: 'üî¨', color: '#50C878', progress: 60, gameCount: 2 },
                        { id: 'social_studies', name: 'Social Studies', icon: 'üåç', color: '#9B59B6', progress: 55, gameCount: 2 }
                    ];
                } else {
                    // Subjects for grades 11-12
                    subjects = [
                        { id: 'english', name: 'English', icon: 'üìö', color: '#FF6B6B', progress: 85, gameCount: 2 },
                        { id: 'odia', name: 'Odia', icon: 'üèõÔ∏è', color: '#FF8C00', progress: 78, gameCount: 2 },
                        { id: 'mathematics', name: 'Mathematics', icon: 'üî¢', color: '#4A90E2', progress: 75, gameCount: 2 },
                        { id: 'biology', name: 'Biology', icon: 'üß¨', color: '#32CD32', progress: 70, gameCount: 2 },
                        { id: 'physics', name: 'Physics', icon: '‚öõÔ∏è', color: '#1E90FF', progress: 68, gameCount: 2 },
                        { id: 'chemistry', name: 'Chemistry', icon: 'üß™', color: '#FF4500', progress: 72, gameCount: 2 },
                        { id: 'computer_science', name: 'Computer Science', icon: 'üíª', color: '#8A2BE2', progress: 80, gameCount: 2 },
                        { id: 'economics', name: 'Economics', icon: 'üìà', color: '#DAA520', progress: 65, gameCount: 2 },
                        { id: 'commerce', name: 'Commerce', icon: 'üíº', color: '#B8860B', progress: 70, gameCount: 2 },
                        { id: 'history', name: 'History', icon: 'üè∫', color: '#CD853F', progress: 68, gameCount: 2 },
                        { id: 'business_mathematics', name: 'Business Mathematics', icon: 'üìä', color: '#4682B4', progress: 73, gameCount: 2 },
                        { id: 'accountancy', name: 'Accountancy', icon: 'üìã', color: '#2F4F4F', progress: 71, gameCount: 2 },
                        { id: 'civics', name: 'Civics', icon: 'üèõÔ∏è', color: '#696969', progress: 67, gameCount: 2 }
                    ];
                }
            }

            const grid = document.getElementById('subjectsGrid');
            grid.innerHTML = '';

            subjects.forEach(subject => {
                const div = document.createElement('div');
                div.className = 'subject-card';
                div.style.borderColor = subject.color;
                div.onclick = () => openSubject(subject.id);
                
                div.innerHTML = `
                    <div class="subject-icon" style="background-color: ${subject.color}20; color: ${subject.color}">
                        ${subject.icon}
                    </div>
                    <div class="subject-info">
                        <h4 data-i18n-key="${subject.id}">${subject.name}</h4>
                        <p style="font-size: 0.8rem; color: #666; margin: 0.25rem 0;">${subject.gameCount} games available</p>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${subject.progress}%; background-color: ${subject.color}"></div>
                        </div>
                        <div class="progress-text">${subject.progress}% Complete</div>
                    </div>
                `;
                
                grid.appendChild(div);
            });
        }
        
        function getSubjectConfig(subjectName) {
            const configs = {
                'English': { icon: 'üìö', color: '#FF6B6B' },
                'Odia': { icon: 'üèõÔ∏è', color: '#FF8C00' },
                'Mathematics': { icon: 'üî¢', color: '#4A90E2' },
                'Science': { icon: 'üî¨', color: '#50C878' },
                'Social Studies': { icon: 'üåç', color: '#9B59B6' },
                'Biology': { icon: 'üß¨', color: '#32CD32' },
                'Physics': { icon: '‚öõÔ∏è', color: '#1E90FF' },
                'Chemistry': { icon: 'üß™', color: '#FF4500' },
                'Computer Science': { icon: 'üíª', color: '#8A2BE2' },
                'Economics': { icon: 'üìà', color: '#DAA520' },
                'Commerce': { icon: 'üíº', color: '#B8860B' },
                'History': { icon: 'üè∫', color: '#CD853F' },
                'Business Mathematics': { icon: 'üìä', color: '#4682B4' },
                'Accountancy': { icon: 'üìã', color: '#2F4F4F' },
                'Civics': { icon: 'üèõÔ∏è', color: '#696969' }
            };
            
            return configs[subjectName] || { icon: 'üìñ', color: '#666666' };
        }

        function loadRecommendedGames() {
            let games = [];
            
            if (window.gameLoader) {
                // Get recommended games from game loader
                games = window.gameLoader.getRecommendedGames(currentGrade);
            } else {
                // Fallback games
                if (currentGrade <= 10) {
                    games = [
                        { id: 'odia_akshara_master', name: '‡¨Ö‡¨ï‡≠ç‡¨∑‡¨∞ ‡¨Æ‡¨æ‡¨∑‡≠ç‡¨ü‡¨∞', subject: 'Odia', difficulty: 'medium', icon: 'üèõÔ∏è' },
                        { id: 'number_ninja', name: '‡¨∏‡¨Ç‡¨ñ‡≠ç‡≠ü‡¨æ ‡¨®‡¨ø‡¨û‡≠ç‡¨ú‡¨æ', subject: 'Mathematics', difficulty: 'medium', icon: 'üî¢' },
                        { id: 'nature_lab', name: '‡¨™‡≠ç‡¨∞‡¨ï‡≠É‡¨§‡¨ø ‡¨≤‡≠ç‡≠ü‡¨æ‡¨¨', subject: 'Science', difficulty: 'medium', icon: 'üî¨' },
                        { id: 'odisha_heritage', name: '‡¨ì‡¨°‡¨ø‡¨∂‡¨æ ‡¨ê‡¨§‡¨ø‡¨π‡≠ç‡≠ü', subject: 'Social Studies', difficulty: 'medium', icon: 'üåç' },
                        { id: 'grammar_quest', name: 'Grammar Quest', subject: 'English', difficulty: 'medium', icon: 'üìö' }
                    ];
                } else {
                    games = [
                        { id: 'mechanics_lab', name: '‡¨Ø‡¨æ‡¨®‡≠ç‡¨§‡≠ç‡¨∞‡¨ø‡¨ï ‡¨¨‡¨ø‡¨ú‡≠ç‡¨û‡¨æ‡¨® ‡¨≤‡≠ç‡≠ü‡¨æ‡¨¨', subject: 'Physics', difficulty: 'hard', icon: '‚öõÔ∏è' },
                        { id: 'periodic_master', name: '‡¨™‡¨∞‡≠ç‡¨Ø‡≠ç‡≠ü‡¨æ‡≠ü ‡¨∏‡¨æ‡¨∞‡¨£‡≠Ä ‡¨Æ‡¨æ‡¨∑‡≠ç‡¨ü‡¨∞', subject: 'Chemistry', difficulty: 'hard', icon: 'üß™' },
                        { id: 'genetics_lab', name: '‡¨¨‡¨Ç‡¨∂‡¨æ‡¨®‡≠Å‡¨ï‡≠ç‡¨∞‡¨Æ ‡¨≤‡≠ç‡≠ü‡¨æ‡¨¨', subject: 'Biology', difficulty: 'hard', icon: 'üß¨' },
                        { id: 'programming_challenge', name: '‡¨™‡≠ç‡¨∞‡≠ã‡¨ó‡≠ç‡¨∞‡¨æ‡¨Æ‡¨ø‡¨Ç ‡¨ö‡≠ç‡≠ü‡¨æ‡¨≤‡≠á‡¨û‡≠ç‡¨ú', subject: 'Computer Science', difficulty: 'hard', icon: 'üíª' }
                    ];
                }
            }

            const grid = document.getElementById('gamesGrid');
            grid.innerHTML = '';

            games.forEach(game => {
                const div = document.createElement('div');
                div.className = 'game-card';
                div.onclick = () => playGame(game.id);
                
                const difficultyColor = game.difficulty === 'easy' ? '#50C878' : 
                                      game.difficulty === 'medium' ? '#FFD93D' : '#FF6B6B';
                
                div.innerHTML = `
                    <div class="game-icon">${game.icon}</div>
                    <div class="game-info">
                        <h4 data-i18n-key="${game.id}">${game.name}</h4>
                        <p class="game-subject">${game.subject}</p>
                        <span class="difficulty-badge" style="background-color: ${difficultyColor}20; color: ${difficultyColor}" 
                              data-i18n-key="${game.difficulty}">${game.difficulty}</span>
                    </div>
                `;
                
                grid.appendChild(div);
            });
        }

        function openSubject(subjectId) {
            // Navigate to subject-specific games/quizzes
            window.location.href = `/games/grade_${currentGrade}/${subjectId}/`;
        }

        function playGame(gameId) {
            // Navigate to specific game
            window.location.href = `/game/grade_${currentGrade}/${gameId}`;
        }
    </script>
</body>
</html>